-- creating a database
create database BikeStorePracticeDB;

USE BikeStorePracticeDB;

-- create schemas in BikeStoreDB
create schema production;

create schema sales;

-- create tables inside production schema

create table production.categories(
 category_id int identity(1,1) primary key,
 category_name varchar(255) not null);

 create table production.brands(
  brand_id int identity(1,1) primary key,
  brand_name varchar(255) not null);

create table production.products(
 product_id int identity(1,1) primary key,
 product_name varchar(255) not null,
 brand_id int not null,
 category_id int not null,
 model_year smallint not null,
 list_price decimal(10,2) not null,
 foreign key (category_id) references production.categories (category_id) on delete cascade on update cascade,
 foreign key (brand_id) references production.brands(brand_id) on delete cascade on update cascade);

create table sales.customers(
  customer_id int identity(1,1) primary key,
  first_name varchar(255) not null,
  last_name varchar(255) not null,
  phone varchar (25),
  email varchar(255) not null,
  street varchar(255),
  city varchar(255),
  state varchar(255),
  zip_code varchar(5)
  );

create database PracticeDB;

use PracticeDB;

alter database PracticeDB modify name = PracticeDB1;
drop database PracticeDB1;
use BikeStorePracticeDB;

create table employee(
 emp_id int identity(1,1) primary key,
 emp_name varchar(255) not null,
 salary decimal(10,2) not null);

insert into employee(emp_name,salary)
values
('EMP1',7000.00),
('EMP2',43000.00),
('EMP4',45000.00);

select * from employee;

update employee
set salary=40000.00
where emp_id=1;

alter table employee add dept varchar(255);
update employee
set dept='sales'
where emp_id=1;

update employee
set dept='hr'
where emp_id=2;

update employee
set dept='marketing'
where emp_id=3;

insert into employee(emp_name,salary,dept)
values
('EMP4',50000.00,'Production');

delete from employee
where emp_id=4;

alter table employee
add email varchar(255);

alter table employee
drop column email;

select * from employee;

exec sp_rename 'employee.email','mail_id','column';

drop table employee;

use PracticeDB;
create table Faculty(
Fid varchar(5),
Fname varchar(15),
Salary int,
depid varchar(5)
);
select * from Faculty;

INSERT INTO Faculty(Fid,Fname,Salary,depid) 
VALUES
('E1','John',45000,'D1'),
('E2','Mary',60000,'D2'),
('E3','Steve',73000,'D3'),
('E4','Helen',86000,'D4'),
('E5','Joe',35000,'D7');

alter table Faculty
drop column depid;

alter table Faculty
add DepId varchar(25);

update Faculty
set DepId='D1'
where Fid='E1';
update Faculty
set DepId='D2'
where Fid='E2';
update Faculty
set DepId='D3'
where Fid='E3';
update Faculty
set DepId='D4'
where Fid='E4';
update Faculty
set DepId='D5'
where Fid='E5';

select * from Faculty;

update Faculty
set salary=40000
where
Fid='E1';

delete from Faculty
where
Fid='E4';

select * from employee;
truncate table employee;
drop table employee;

update Faculty
set Fname='Finn'
where
Fname='Joe';
select * from Faculty;

select count(*) from Faculty;

exec sp_rename 'Faculty','Employee';

exec sp_rename 'Employee','Faculty';

alter table Faculty
add email varchar(25);

select * from Faculty;

update Faculty
set email='Unknown'
where email is null;

alter table Faculty
add DOJ date;

select * from Faculty;

update Faculty
set DOJ='2025-10-21'
where DOJ is null;

select * from Faculty;

update Faculty
set email='John@email.com'
where
Fname='John';

update Faculty
set email='Mary@email.com'
where
Fname='Mary';

update Faculty
set email='steve@email.com'
where
Fname='Steve';

delete from Faculty
where email not like '%email.com';

insert into Faculty(Fid,Fname,Salary,DepId,email,DOJ)
values
('E4','Joe','54000','D4','Joe@email.com','2025-10-10'),
('E5','Jack','40000','D5','Jack@email.com','2025-10-11');

select * from Faculty;

insert into Faculty(Fid,Fname,Salary,DepId,email,DOJ)
values
('E6','Jim','51000','D3','Jim@email.com','2025-10-10'),
('E7','Jill','40000','D1','Jill@email.com','2025-10-11');

select * from Faculty
where Salary>55000;

select * from Faculty
where DepId='D1';

select * from Faculty
where salary > (select avg(Salary) from faculty);

select avg(Salary) as Avg_salary from faculty;

select DepId,sum(Salary) as Total_salary from Faculty
group by DepId;

select distinct DepId from Faculty;

select DepId, count(DepId) as Faculty_count from Faculty
group by DepId;

select Fname from Faculty 
where
Fname like '%hn%';

select Fname from Faculty
where
Fname like 'J%';

update Faculty 
set Salary = (select avg(Salary) from Faculty)
where
Salary<(select avg(salary) from Faculty);

select * from Faculty;

select avg(salary) from Faculty;

select DepId,salary
from faculty;

select Fname,salary,DepId
from faculty
where
DepId='D1';

select DepId,sum(salary) as Dep_total_salary from faculty
group by DepId order by Dep_total_salary desc;

update Faculty
set Salary=80000
where Fname='Steve';

select DOJ,count(Fname) from Faculty
group by DOJ order by DOJ desc;

select DepId,max(salary)as Max_Salary from Faculty
group by DepId;

select DepId, min(Salary) as min_salary,avg(Salary)as avg_salary,Max(Salary)as Max_salary,Count(Fname) as Count_
from Faculty
group by DepId;

select DepId, sum(Salary) as sum_salary,min(Salary) as min_salary,avg(Salary)as avg_salary,Max(Salary)as Max_salary,Count(Fname) as Count_
from Faculty
group by DepId
having avg(salary)>52000 order by avg(salary);

create table Dept(
 DepId varchar(255),
 DepName varchar(255),
 Location varchar(255)
 );

 insert into Dept(DepId,DepName,Location)
 values
 ('D1','HR','Chicago'),
 ('D2','Finance','New York'),
 ('D3','Engineering','San Francisco'),
 ('D4','Sales','Boston'),
 ('D5','Marketing','Seattle');

select * from Dept;

select F.Fname,F.DepId,D.DepName
from
Faculty as F
inner join
Dept as D
on
F.DepId=D.DepId;

select F.Fname,D.DepId,D.DepName
from Faculty as F
left join
Dept as D
on
F.DepId=D.DepId;

select F.Fname,D.DepId,D.DepName
from Faculty as F
right join
Dept as D
on
F.DepId=D.DepId;

insert into Dept(DepId,DepName,location)
values
('D6','Legal','Houston');

select * from Faculty;

insert into Faculty(Fid,Fname,Salary)
values
('E8','Carla',74000);

select * from Faculty
where DOJ < '2025-10-11';

update Faculty
set DOJ='2025-09-12'
where
Fid='E4';

update Faculty
set DOJ='2025-08-23'
where
Fid='E3';

update Faculty 
set DOJ='2024-11-03'
where
Fid='E1';

select * from Faculty
where month(DOJ) = 08;

select * from Faculty
where DOJ
between '2024-01-01'
and
'2026-01-01';

select * from Faculty
order by DOJ;

select * from Faculty
order by month(DOJ);

select * from Faculty
order by day(DOJ),Fid;

select count(*) from Faculty
where DOJ is null;

select * from Faculty
where DOJ is not null;

alter table Dept
drop column Location;

select * from Dept;
